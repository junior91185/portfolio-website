<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SQL Murder Mystery Project</title>
    <link rel="stylesheet" href="css/styles_iam.css">
    <link rel="stylesheet" href="css/nav.css">
    <style>
        /* Override bold styling */
        h1, h2, h3, strong {
            font-weight: 500;
        }
        p, li, code {
            font-weight: 400;
        }
    </style>
</head>
<body>
    <header class="header">
        <nav class="menu">
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="projects.html">Projects</a></li>
            </ul>  
        </nav>
    </header>

    <div class="project-container">
        <h1>SQL Murder Mystery</h1>

        <p>
            This project is based on the 
            <a href="https://mystery.knightlab.com/" target="_blank">SQL Murder Mystery</a> challenge.  
            I used Microsoft SQL Server to explore and connect multiple datasets to solve a simulated crime.
        </p>

        <h2>Setting Up</h2>
        <p>
            After downloading the database tables, the first thing I did was set up proper foreign key relationships 
            between them. This ensured that data could be joined accurately and that relationships 
            between tables like <code>person</code>, <code>drivers_license</code>, and 
            <code>facebook_event_checkin</code> were consistent.
        </p>

        <pre><code>ALTER TABLE dbo.facebook_event_checkin
ADD CONSTRAINT FK_facebook_event_checkin_person
FOREIGN KEY (person_id) REFERENCES dbo.person(id);

ALTER TABLE dbo.get_fit_now_member
ADD CONSTRAINT FK_get_fit_now_member_person
FOREIGN KEY (person_id) REFERENCES dbo.person(id);

ALTER TABLE dbo.interview
ADD CONSTRAINT FK_interview_person
FOREIGN KEY (person_id) REFERENCES dbo.person(id);
-- (add_foreignkeys.sql)
</code></pre>

        <h2>Exploring the Data</h2>
        <p>
            I began by exploring the main tables — <code>crime_scene_report</code>, <code>person</code>, and 
            <code>interview</code> — to understand what type of data was available and how it connected.
        </p>
        <pre><code>SELECT TOP 5 * FROM dbo.crime_scene_report;
SELECT TOP 5 * FROM dbo.person;
SELECT TOP 5 * FROM dbo.interview;
GO
-- (explore.sql)
</code></pre>

        <h2>First Suspect</h2>
        <p>
            The first lead came from the crime report in SQL City. Using witness information, I searched 
            the <code>person</code> and <code>interview</code> tables to locate two people living near the 
            crime scene. One of them, who lived on Franklin Ave, provided a clue pointing to the suspect’s car.
        </p>

        <pre><code>SELECT *
FROM dbo.person p
INNER JOIN dbo.interview i
    ON p.id = i.person_id
WHERE name LIKE 'Annabel%' AND address_street_name = 'Franklin Ave';

SELECT *
FROM dbo.person p
INNER JOIN dbo.interview i
    ON p.id = i.person_id
WHERE address_street_name = 'Northwestern Dr'
  AND address_number = (
      SELECT MAX(address_number)
      FROM dbo.person
      WHERE address_street_name = 'Northwestern Dr'
  );
-- (Witness_Statements.sql)
</code></pre>

        <h2>Tracking the First Suspect</h2>
        <p>
            The lead pointed to someone driving a red Tesla. I joined the <code>drivers_license</code>, 
            <code>person</code>, and <code>facebook_event_checkin</code> tables to find a match.  
            This revealed that the suspect attended the "SQL Symphony Concert" multiple times.
        </p>

        <pre><code>SELECT 
    dl.age, dl.hair_color, dl.car_make, dl.car_model,
    p.name, fb.event_name, fb.date
FROM dbo.drivers_liscense dl
INNER JOIN dbo.person p ON dl.id = p.liscense_id
INNER JOIN dbo.facebook_event_checkin fb ON p.id = fb.person_id
WHERE hair_color = 'red'
  AND car_make LIKE 'Tesla%'
  AND date BETWEEN '2017-12-01' AND '2017-12-31';
-- (First_Suspect_J.B.sql)
</code></pre>

        <h2>Second Suspect</h2>
        <p>
            I then analyzed fitness club records using the <code>get_fit_now_member</code> and 
            <code>get_fit_now_check_in</code> tables.  
            This helped confirm the second suspect's identity and match it with interview evidence.
        </p>

        <pre><code>SELECT 
    ck.check_in_date,
    membership_id,
    m.person_id, 
    p.name, 
    p.address_number,
    i.transcript
FROM dbo.get_fit_now_member m
INNER JOIN dbo.get_fit_now_check_in ck ON m.id = ck.membership_id
INNER JOIN dbo.person p ON m.person_id = p.id
INNER JOIN dbo.interview i ON p.id = i.person_id
WHERE ck.check_in_date = '2018-01-09'
  AND ck.membership_id LIKE '48Z%';
-- (Second_Suspect_M.P.sql)
</code></pre>

        <h2>Conclusion</h2>
        <p>
            By connecting information from witness statements, license data, and event attendance,  
            I was able to piece together the sequence of events and identify the true culprit.  
            This project strengthened my SQL querying skills and showed how relational data 
            can tell a complete story through logical reasoning.
        </p>

        <br>
        <a href="projects.html" class="back-button">← Back to Projects</a>
        <a href="https://github.com/junior91185/sql-murder-mystery" 
           target="_blank" class="project-link">GitHub</a>
    </div>
</body>
</html>
